<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SplitChunksPlugin | Meteor</title>
    <meta name="description" content="欢迎来到我的个人页面">
    
    
    <link rel="preload" href="/MyBlog/assets/css/23.styles.cc84573a.css" as="style"><link rel="preload" href="/MyBlog/assets/js/app.19eb8d83.js" as="script"><link rel="preload" href="/MyBlog/assets/js/8.4320c542.js" as="script"><link rel="prefetch" href="/MyBlog/assets/js/12.53cafe37.js"><link rel="prefetch" href="/MyBlog/assets/js/1.38c1cab2.js"><link rel="prefetch" href="/MyBlog/assets/js/2.493d4717.js"><link rel="prefetch" href="/MyBlog/assets/js/3.fec61410.js"><link rel="prefetch" href="/MyBlog/assets/js/4.7b46e1a9.js"><link rel="prefetch" href="/MyBlog/assets/js/5.a8da7034.js"><link rel="prefetch" href="/MyBlog/assets/js/6.1afa3de3.js"><link rel="prefetch" href="/MyBlog/assets/js/7.bb628056.js"><link rel="prefetch" href="/MyBlog/assets/js/9.ae9485eb.js"><link rel="prefetch" href="/MyBlog/assets/js/10.4f6f2f80.js"><link rel="prefetch" href="/MyBlog/assets/js/11.3dd0d6bb.js"><link rel="prefetch" href="/MyBlog/assets/js/13.4a7a2bd8.js"><link rel="prefetch" href="/MyBlog/assets/js/14.fd64b4ff.js"><link rel="prefetch" href="/MyBlog/assets/js/15.0aea93d5.js"><link rel="prefetch" href="/MyBlog/assets/js/16.205e0222.js"><link rel="prefetch" href="/MyBlog/assets/js/17.23dda7fa.js"><link rel="prefetch" href="/MyBlog/assets/js/18.9a90913a.js"><link rel="prefetch" href="/MyBlog/assets/js/19.217ac63a.js"><link rel="prefetch" href="/MyBlog/assets/js/20.e5f657ab.js"><link rel="prefetch" href="/MyBlog/assets/js/21.a7e51597.js"><link rel="prefetch" href="/MyBlog/assets/js/22.4c47086b.js">
    <link rel="stylesheet" href="/MyBlog/assets/css/23.styles.cc84573a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/MyBlog/" class="home-link router-link-active"><!----><span class="site-name">
      Meteor
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/MyBlog/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">博客</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="https://github.com/MeteorOCC" target="_blank" rel="noopener noreferrer" class="nav-link external">
  正在动工,可先使用搜索栏搜索关键字寻找博文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">github</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="https://github.com/MeteorOCC" target="_blank" rel="noopener noreferrer" class="nav-link external">
  并没有这一个选项quq
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/MyBlog/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">博客</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="https://github.com/MeteorOCC" target="_blank" rel="noopener noreferrer" class="nav-link external">
  正在动工,可先使用搜索栏搜索关键字寻找博文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">github</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="https://github.com/MeteorOCC" target="_blank" rel="noopener noreferrer" class="nav-link external">
  并没有这一个选项quq
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><!----></nav><!----></div><div class="page"><div class="content"><h2 id="splitchunksplugin"><a href="#splitchunksplugin" aria-hidden="true" class="header-anchor">#</a> SplitChunksPlugin</h2><p>最开始的时候<code>chunk</code>(及在其中导入的模块)内部通过Webpack图中的<code>parent-child</code>关系相互联动。</p><p>从Webpack4开始，<code>CommonsChunkPlugin</code>被删除，新增<code>optimization.splitChunks</code>和<code>optimization.runtimeChunk</code>这两个选项来代替<code>CommonsChunkPlugin</code>的功能并优化。</p><h3 id="默认情况"><a href="#默认情况" aria-hidden="true" class="header-anchor">#</a> 默认情况</h3><p>默认情况下的<code>SplitChunksPlugin</code>适合大多数用户。</p><p><code>SplitChunksPlugin</code>默认情况下仅会影响按需加载的模块(更改初始模块会影响HTML文件应该包含的脚本及运行项)</p><p>Webpack根据以下条件自动拆分模块：</p><ul><li>可以共享新<code>chunk</code>或来自<code>node_modules</code>文件夹的模块</li><li>新<code>chunk</code>将大于30kb(min+gz之前)</li><li>最大异步请求数小于或等于5</li><li>初始页面加载时最大异步请求数将小于或等于3</li></ul><p>当满足最后两个条件时，会首先选择最大的<code>chunk</code>进行分割。</p><p>For Example</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//index.js</span>
<span class="token comment">//dynamically import a.js</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// a.js</span>
<span class="token keyword">import</span> <span class="token string">&quot;react&quot;</span>
</code></pre></div><p>打包结果：创建一个包含<code>react</code>的单独<code>chunk</code>，导入调用的时候，这个<code>chunk</code>和包含的原始<code>chunk</code>异步加载</p><p>Why？</p><ul><li>该<code>chunk</code>来自模块的node_modules</li><li><code>react</code>大于30kb</li><li>调用时异步请求数为2</li><li>非影响初始页面加载的请求</li></ul><p>Example2：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//entry.js</span>
<span class="token comment">//dynamically import a.js and b.js</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./a'</span><span class="token punctuation">)</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./b'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// a.js</span>
<span class="token keyword">import</span> <span class="token string">'./helpers'</span> <span class="token comment">// helpers is 40kb in size</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//b.js</span>
<span class="token keyword">import</span> <span class="token string">'./helpers'</span>
<span class="token keyword">import</span> <span class="token string">'./more-helpers'</span><span class="token comment">// more-helpers is also 40kb in size</span>
</code></pre></div><p>打包结果：创建一个单独<code>chunk</code>，内含<code>./helpers</code>所有的依赖项，调用时，模块和原始<code>chunk</code>异步加载。</p><p>Why？</p><ul><li>两个导入的js含共享的<code>./helpers</code></li><li><code>helpers</code>大于30kb</li><li>调用时异步请求数为2</li><li>非影响初始页面加载的请求</li></ul><p>Webpack认为如果像<code>helpers</code>这样的代码块通过额外的请求来使用，性能是要优于将<code>helpers</code>放入每个<code>chunk</code>导致<code>helpers</code>被下载两次的。尽管<code>额外的请求</code>依然是个额外的负担，但是至少它比连续下载两次更好更快的完成了任务。</p><h3 id="供开发人员定制的配置文件"><a href="#供开发人员定制的配置文件" aria-hidden="true" class="header-anchor">#</a> 供开发人员定制的配置文件</h3><p>对于那些想对SplitChunksPlugin默认状况进行修改以适应项目的开发人员，Webpack提供了可选的配置选项来更好的满足开发人员的要求。</p><blockquote><p><code>CommonsChunkPlugin</code>会导致下载的代码多过所需的代码，异步效率上面比较低，难以使用，过程也难以被理解。</p><p><code>SplitChunksPlugin</code>解决了上述大部分问题，但是在一些构建较为特殊的项目中，可能会导致一些意想不到的问题</p></blockquote><h4 id="configuring-cache-groups-缓存组？"><a href="#configuring-cache-groups-缓存组？" aria-hidden="true" class="header-anchor">#</a> Configuring cache groups(缓存组？)</h4><blockquote><p>Vendor，一般译为第三方依赖。比如说项目中像Vue、Vue-router、FinoChat、vee-validate、mint-UI、Vuex、Axios这类从第三方引入可以直接使用其功能的模块都将被Webpack打包至Vendor中。</p></blockquote><p>默认将所有来自<code>node_modules</code>的模块分配给<code>vendor</code></p><p>可以将模块分配给多个<code>cache groups</code>，然后选择优先度较高的<code>priority</code>(<code>priority</code>选项)的<code>cache groups</code>或者优先度较高的<code>chunk</code></p><h4 id="形成新块的基本配置"><a href="#形成新块的基本配置" aria-hidden="true" class="header-anchor">#</a> 形成新块的基本配置</h4><p>当满足所有的options时，来自相同<code>chunk</code>和<code>cache groups</code>的模块将形成新的<code>chunk</code></p><p>options:</p><ul><li><code>minSize</code> （默认值30000即30kb）<code>chunk</code>最小大小</li><li><code>minChunks</code>（默认值1）拆分前共享模块的最小<code>chunk</code>数</li><li><code>maxInitialRequests</code>(默认值3) 入口的最大异步请求数</li><li><code>maxAsyncRequests</code>(默认值5) 按需加载时的最大异步请求数</li></ul><h4 id="命名"><a href="#命名" aria-hidden="true" class="header-anchor">#</a> 命名</h4><p>控制被分割的<code>chunk</code>的名字，<code>name</code>为可选项</p><p>当<code>name</code>为<code>true</code>时，Webpack会自动帮你命名(基于<code>chunks</code>和<code>cache groups</code>中的key)被分割的<code>chunk</code>的名字，否则将传递字符串或者方法的名为<code>chunk</code>的名字。</p><p>当<code>name</code>匹配为入口<code>entry</code>的名字，那么<code>entry</code>将会被移除。</p><h4 id="optimization-splitchunks-automaticnamedelimiter"><a href="#optimization-splitchunks-automaticnamedelimiter" aria-hidden="true" class="header-anchor">#</a><code>optimization.splitChunks.automaticNameDelimiter</code></h4><p>默认情况下，Webpack将使用初始名或者<code>chunk</code>的名字来生成名称，比如说<code>vendors~main.js</code></p><p>如果你的项目与<code>~</code>这个关键字有冲突，可以通过这个选项设置为适用于项目的其他任何值，比如说<code>-</code></p><h4 id="选择模块"><a href="#选择模块" aria-hidden="true" class="header-anchor">#</a> 选择模块</h4><p><code>test</code>选项控制被<code>cache group</code>选择的模块</p><p>如果省略，它将选择所有模块，一般来说这个选项不可被忽略。</p><p>可以是正则表达式（一般也是这么用），也可以是字符串或者函数。</p><p>可匹配绝对路径的模块或者<code>chunk</code>名称，匹配<code>chunk</code>名称时，将选择这个<code>chunk</code>内的所有模块。</p><h4 id="选择chunk"><a href="#选择chunk" aria-hidden="true" class="header-anchor">#</a> 选择<code>chunk</code></h4><p><code>chunks</code>选项可以配置所选的<code>chunk</code></p><p><code>chunks</code>有三个值：<code>initial</code>,<code>async</code>,<code>all</code>。</p><p><code>reuseExistingChunk</code>当模块完全匹配时，该选项允许重用现有<code>chunk</code>而不是创建新<code>chunk</code></p><p>可以按照<code>cache group</code>进行控制</p><h3 id="optimization-splitchunks-chunks-all"><a href="#optimization-splitchunks-chunks-all" aria-hidden="true" class="header-anchor">#</a><code>optimization.splitChunks.chunks: all</code></h3><p>初始<code>chunk</code>将受到影响(即使是未按需加载的模块)，这样甚至可以在entry point和按需加载的模块之间共享<code>chunk</code></p><p>这是推荐的配置。</p><h2 id="optimization-splitchunks"><a href="#optimization-splitchunks" aria-hidden="true" class="header-anchor">#</a><code>optimization.splitChunks</code></h2><p>配置<code>SplitChunksPlugin</code>的默认行为</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    chunks<span class="token punctuation">:</span> <span class="token string">&quot;async&quot;</span><span class="token punctuation">,</span>
    minSize<span class="token punctuation">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>
    minChunks<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    maxAsyncRequests<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    maxInitialRequests<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    automaticNameDelimiter<span class="token punctuation">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        vendors<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            test<span class="token punctuation">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
            priority<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            minChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            priority<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span>
            reuseExistingChunk<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>以下是一些示例和效果：</p><p>Example1</p><p>创建一個<code>commons</code><code>chunk</code>，其中包括entry之間共享的所有代碼。</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        commons<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;commons&quot;</span><span class="token punctuation">,</span>
            chunks<span class="token punctuation">:</span> <span class="token string">&quot;initial&quot;</span><span class="token punctuation">,</span>
            minChunks<span class="token punctuation">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>此配置可以拓展初始以来包，建议在不立即需要模块時使用按需加载</p></blockquote><p>Example2</p><p>创建一個<code>vendors</code><code>chunk</code></p><div class="language-javascript extra-class"><pre class="language-javascript"><code>splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        commons<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            test<span class="token punctuation">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;vendors&quot;</span><span class="token punctuation">,</span>
            chunks<span class="token punctuation">:</span> <span class="token string">&quot;all&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>包含所有第三方包的大<code>chunk</code>。建议仅包含核心框架和实用依赖，其它的业务上的东西建议按需加载。</p></blockquote><h2 id="optimization-runtimechunk"><a href="#optimization-runtimechunk" aria-hidden="true" class="header-anchor">#</a><code>optimization.runtimeChunk</code></h2><p>单独生成一个<code>chunk</code>，用于管理所有<code>chunk</code>的依赖和按需加载。</p></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/MyBlog/assets/js/8.4320c542.js" defer></script><script src="/MyBlog/assets/js/app.19eb8d83.js" defer></script>
  </body>
</html>
