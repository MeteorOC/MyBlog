(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{171:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h2",{attrs:{id:"splitchunksplugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#splitchunksplugin","aria-hidden":"true"}},[t._v("#")]),t._v(" SplitChunksPlugin")]),a("p",[t._v("最开始的时候"),a("code",[t._v("chunk")]),t._v("(及在其中导入的模块)内部通过Webpack图中的"),a("code",[t._v("parent-child")]),t._v("关系相互联动。")]),a("p",[t._v("从Webpack4开始，"),a("code",[t._v("CommonsChunkPlugin")]),t._v("被删除，新增"),a("code",[t._v("optimization.splitChunks")]),t._v("和"),a("code",[t._v("optimization.runtimeChunk")]),t._v("这两个选项来代替"),a("code",[t._v("CommonsChunkPlugin")]),t._v("的功能并优化。")]),a("h3",{attrs:{id:"默认情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#默认情况","aria-hidden":"true"}},[t._v("#")]),t._v(" 默认情况")]),a("p",[t._v("默认情况下的"),a("code",[t._v("SplitChunksPlugin")]),t._v("适合大多数用户。")]),a("p",[a("code",[t._v("SplitChunksPlugin")]),t._v("默认情况下仅会影响按需加载的模块(更改初始模块会影响HTML文件应该包含的脚本及运行项)")]),a("p",[t._v("Webpack根据以下条件自动拆分模块：")]),a("ul",[a("li",[t._v("可以共享新"),a("code",[t._v("chunk")]),t._v("或来自"),a("code",[t._v("node_modules")]),t._v("文件夹的模块")]),a("li",[t._v("新"),a("code",[t._v("chunk")]),t._v("将大于30kb(min+gz之前)")]),a("li",[t._v("最大异步请求数小于或等于5")]),a("li",[t._v("初始页面加载时最大异步请求数将小于或等于3")])]),a("p",[t._v("当满足最后两个条件时，会首先选择最大的"),a("code",[t._v("chunk")]),t._v("进行分割。")]),a("p",[t._v("For Example")]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("//index.js")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("//dynamically import a.js")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'./a'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// a.js")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"react"')]),t._v("\n")])])]),a("p",[t._v("打包结果：创建一个包含"),a("code",[t._v("react")]),t._v("的单独"),a("code",[t._v("chunk")]),t._v("，导入调用的时候，这个"),a("code",[t._v("chunk")]),t._v("和包含的原始"),a("code",[t._v("chunk")]),t._v("异步加载")]),a("p",[t._v("Why？")]),a("ul",[a("li",[t._v("该"),a("code",[t._v("chunk")]),t._v("来自模块的node_modules")]),a("li",[a("code",[t._v("react")]),t._v("大于30kb")]),a("li",[t._v("调用时异步请求数为2")]),a("li",[t._v("非影响初始页面加载的请求")])]),a("p",[t._v("Example2：")]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("//entry.js")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("//dynamically import a.js and b.js")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'./a'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'./b'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// a.js")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'./helpers'")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// helpers is 40kb in size")]),t._v("\n")])])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("//b.js")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'./helpers'")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'./more-helpers'")]),a("span",{attrs:{class:"token comment"}},[t._v("// more-helpers is also 40kb in size")]),t._v("\n")])])]),a("p",[t._v("打包结果：创建一个单独"),a("code",[t._v("chunk")]),t._v("，内含"),a("code",[t._v("./helpers")]),t._v("所有的依赖项，调用时，模块和原始"),a("code",[t._v("chunk")]),t._v("异步加载。")]),a("p",[t._v("Why？")]),a("ul",[a("li",[t._v("两个导入的js含共享的"),a("code",[t._v("./helpers")])]),a("li",[a("code",[t._v("helpers")]),t._v("大于30kb")]),a("li",[t._v("调用时异步请求数为2")]),a("li",[t._v("非影响初始页面加载的请求")])]),a("p",[t._v("Webpack认为如果像"),a("code",[t._v("helpers")]),t._v("这样的代码块通过额外的请求来使用，性能是要优于将"),a("code",[t._v("helpers")]),t._v("放入每个"),a("code",[t._v("chunk")]),t._v("导致"),a("code",[t._v("helpers")]),t._v("被下载两次的。尽管"),a("code",[t._v("额外的请求")]),t._v("依然是个额外的负担，但是至少它比连续下载两次更好更快的完成了任务。")]),a("h3",{attrs:{id:"供开发人员定制的配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#供开发人员定制的配置文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 供开发人员定制的配置文件")]),a("p",[t._v("对于那些想对SplitChunksPlugin默认状况进行修改以适应项目的开发人员，Webpack提供了可选的配置选项来更好的满足开发人员的要求。")]),a("blockquote",[a("p",[a("code",[t._v("CommonsChunkPlugin")]),t._v("会导致下载的代码多过所需的代码，异步效率上面比较低，难以使用，过程也难以被理解。")]),a("p",[a("code",[t._v("SplitChunksPlugin")]),t._v("解决了上述大部分问题，但是在一些构建较为特殊的项目中，可能会导致一些意想不到的问题")])]),a("h4",{attrs:{id:"configuring-cache-groups-缓存组？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuring-cache-groups-缓存组？","aria-hidden":"true"}},[t._v("#")]),t._v(" Configuring cache groups(缓存组？)")]),a("blockquote",[a("p",[t._v("Vendor，一般译为第三方依赖。比如说项目中像Vue、Vue-router、FinoChat、vee-validate、mint-UI、Vuex、Axios这类从第三方引入可以直接使用其功能的模块都将被Webpack打包至Vendor中。")])]),a("p",[t._v("默认将所有来自"),a("code",[t._v("node_modules")]),t._v("的模块分配给"),a("code",[t._v("vendor")])]),a("p",[t._v("可以将模块分配给多个"),a("code",[t._v("cache groups")]),t._v("，然后选择优先度较高的"),a("code",[t._v("priority")]),t._v("("),a("code",[t._v("priority")]),t._v("选项)的"),a("code",[t._v("cache groups")]),t._v("或者优先度较高的"),a("code",[t._v("chunk")])]),a("h4",{attrs:{id:"形成新块的基本配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#形成新块的基本配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 形成新块的基本配置")]),a("p",[t._v("当满足所有的options时，来自相同"),a("code",[t._v("chunk")]),t._v("和"),a("code",[t._v("cache groups")]),t._v("的模块将形成新的"),a("code",[t._v("chunk")])]),a("p",[t._v("options:")]),a("ul",[a("li",[a("code",[t._v("minSize")]),t._v(" （默认值30000即30kb）"),a("code",[t._v("chunk")]),t._v("最小大小")]),a("li",[a("code",[t._v("minChunks")]),t._v("（默认值1）拆分前共享模块的最小"),a("code",[t._v("chunk")]),t._v("数")]),a("li",[a("code",[t._v("maxInitialRequests")]),t._v("(默认值3) 入口的最大异步请求数")]),a("li",[a("code",[t._v("maxAsyncRequests")]),t._v("(默认值5) 按需加载时的最大异步请求数")])]),a("h4",{attrs:{id:"命名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命名","aria-hidden":"true"}},[t._v("#")]),t._v(" 命名")]),a("p",[t._v("控制被分割的"),a("code",[t._v("chunk")]),t._v("的名字，"),a("code",[t._v("name")]),t._v("为可选项")]),a("p",[t._v("当"),a("code",[t._v("name")]),t._v("为"),a("code",[t._v("true")]),t._v("时，Webpack会自动帮你命名(基于"),a("code",[t._v("chunks")]),t._v("和"),a("code",[t._v("cache groups")]),t._v("中的key)被分割的"),a("code",[t._v("chunk")]),t._v("的名字，否则将传递字符串或者方法的名为"),a("code",[t._v("chunk")]),t._v("的名字。")]),a("p",[t._v("当"),a("code",[t._v("name")]),t._v("匹配为入口"),a("code",[t._v("entry")]),t._v("的名字，那么"),a("code",[t._v("entry")]),t._v("将会被移除。")]),a("h4",{attrs:{id:"optimization-splitchunks-automaticnamedelimiter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#optimization-splitchunks-automaticnamedelimiter","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("optimization.splitChunks.automaticNameDelimiter")])]),a("p",[t._v("默认情况下，Webpack将使用初始名或者"),a("code",[t._v("chunk")]),t._v("的名字来生成名称，比如说"),a("code",[t._v("vendors~main.js")])]),a("p",[t._v("如果你的项目与"),a("code",[t._v("~")]),t._v("这个关键字有冲突，可以通过这个选项设置为适用于项目的其他任何值，比如说"),a("code",[t._v("-")])]),a("h4",{attrs:{id:"选择模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选择模块","aria-hidden":"true"}},[t._v("#")]),t._v(" 选择模块")]),a("p",[a("code",[t._v("test")]),t._v("选项控制被"),a("code",[t._v("cache group")]),t._v("选择的模块")]),a("p",[t._v("如果省略，它将选择所有模块，一般来说这个选项不可被忽略。")]),a("p",[t._v("可以是正则表达式（一般也是这么用），也可以是字符串或者函数。")]),a("p",[t._v("可匹配绝对路径的模块或者"),a("code",[t._v("chunk")]),t._v("名称，匹配"),a("code",[t._v("chunk")]),t._v("名称时，将选择这个"),a("code",[t._v("chunk")]),t._v("内的所有模块。")]),a("h4",{attrs:{id:"选择chunk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选择chunk","aria-hidden":"true"}},[t._v("#")]),t._v(" 选择"),a("code",[t._v("chunk")])]),a("p",[a("code",[t._v("chunks")]),t._v("选项可以配置所选的"),a("code",[t._v("chunk")])]),a("p",[a("code",[t._v("chunks")]),t._v("有三个值："),a("code",[t._v("initial")]),t._v(","),a("code",[t._v("async")]),t._v(","),a("code",[t._v("all")]),t._v("。")]),a("p",[a("code",[t._v("reuseExistingChunk")]),t._v("当模块完全匹配时，该选项允许重用现有"),a("code",[t._v("chunk")]),t._v("而不是创建新"),a("code",[t._v("chunk")])]),a("p",[t._v("可以按照"),a("code",[t._v("cache group")]),t._v("进行控制")]),a("h3",{attrs:{id:"optimization-splitchunks-chunks-all"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#optimization-splitchunks-chunks-all","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("optimization.splitChunks.chunks: all")])]),a("p",[t._v("初始"),a("code",[t._v("chunk")]),t._v("将受到影响(即使是未按需加载的模块)，这样甚至可以在entry point和按需加载的模块之间共享"),a("code",[t._v("chunk")])]),a("p",[t._v("这是推荐的配置。")]),a("h2",{attrs:{id:"optimization-splitchunks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#optimization-splitchunks","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("optimization.splitChunks")])]),a("p",[t._v("配置"),a("code",[t._v("SplitChunksPlugin")]),t._v("的默认行为")]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("splitChunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    chunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"async"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    minSize"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("30000")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    minChunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    maxAsyncRequests"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("5")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    maxInitialRequests"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    automaticNameDelimiter"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'~'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    cacheGroups"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        vendors"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            test"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token regex"}},[t._v("/[\\\\/]node_modules[\\\\/]/")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            priority"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("10")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            minChunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            priority"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("20")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            reuseExistingChunk"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("以下是一些示例和效果：")]),a("p",[t._v("Example1")]),a("p",[t._v("创建一個"),a("code",[t._v("commons")]),a("code",[t._v("chunk")]),t._v("，其中包括entry之間共享的所有代碼。")]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("splitChunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    cacheGroups"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        commons"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            name"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"commons"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            chunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"initial"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            minChunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("此配置可以拓展初始以来包，建议在不立即需要模块時使用按需加载")])]),a("p",[t._v("Example2")]),a("p",[t._v("创建一個"),a("code",[t._v("vendors")]),a("code",[t._v("chunk")])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("splitChunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    cacheGroups"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        commons"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            test"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token regex"}},[t._v("/[\\\\/]node_modules[\\\\/]/")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            name"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"vendors"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            chunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"all"')]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("包含所有第三方包的大"),a("code",[t._v("chunk")]),t._v("。建议仅包含核心框架和实用依赖，其它的业务上的东西建议按需加载。")])]),a("h2",{attrs:{id:"optimization-runtimechunk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#optimization-runtimechunk","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("optimization.runtimeChunk")])]),a("p",[t._v("单独生成一个"),a("code",[t._v("chunk")]),t._v("，用于管理所有"),a("code",[t._v("chunk")]),t._v("的依赖和按需加载。")])])}],!1,null,null,null);e.options.__file="README.md";s.default=e.exports}}]);